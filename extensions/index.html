<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.55">
<link rel="stylesheet" href="react-image-lightbox/style.css"><title data-react-helmet="true">Extending Joern | Joern Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Extending Joern | Joern Documentation"><meta data-react-helmet="true" name="description" content="Joern provides a runtime extension mechanism that allows you to"><meta data-react-helmet="true" property="og:description" content="Joern provides a runtime extension mechanism that allows you to"><meta data-react-helmet="true" property="og:url" content="https://joernio.github.io/extensions"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link data-react-helmet="true" rel="shortcut icon" href="/img/website-icon.png"><link data-react-helmet="true" rel="canonical" href="https://joernio.github.io/extensions"><link rel="stylesheet" href="/styles.d76b5722.css">
<link rel="preload" href="/styles.63ef370e.js" as="script">
<link rel="preload" href="/runtime~main.a8443992.js" as="script">
<link rel="preload" href="/main.4748f629.js" as="script">
<link rel="preload" href="/1.e1eda06e.js" as="script">
<link rel="preload" href="/39.dca14509.js" as="script">
<link rel="preload" href="/1be78505.90797e98.js" as="script">
<link rel="preload" href="/ec1ed54d.6e92f1ec.js" as="script">
<link rel="preload" href="/a4b43bd0.b8428a97.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):(e.matches,t("dark"))}()</script><div id="__docusaurus">
<div class="main-wrapper"><div id="docs" class="docPage_1jis"><div id="sidebar"><div class="docSidebarContainer_1kjN"><div align="center" id="logo"><a href="https://joern.io"><img width="40%" src="/img/logo.svg"></a></div><div class="sidebar_25T_"><div class="menu menu_1e9D"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/home">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" href="/shell">Interactive Shell</a></li><li class="menu__list-item"><a class="menu__link" href="/interpreter">Interpreter</a></li><li class="menu__list-item"><a class="menu__link" href="/exporting">Exporting Graphs</a></li><li class="menu__list-item"><a class="menu__link" href="/server">Server</a></li><li class="menu__list-item"><a class="menu__link" href="/organizing-projects">Workspace</a></li><li class="menu__list-item"><a class="menu__link" href="/code-property-graph">Code Property Graph</a></li><li class="menu__list-item"><a class="menu__link" href="/traversal-basics">Traversal Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/c-syntaxtree">Syntax-Tree Queries</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/extensions">Extending Joern</a></li><li class="menu__list-item"><a class="menu__link" href="/glossary">Glossary</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CPGQL Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/reference-card">Reference Card</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/node-type-steps">Node-Type Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/filter-steps">Filter Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/core-steps">Core Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/repeat-steps">Repeat Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/complex-steps">Complex Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/execution-directives">Execution Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/augmentation-directives">Augmentation Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/help-directive">Help Directive</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/calls">Calls</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/upgrade-guides">Upgrade guides</a></li></ul></div></div></div></div><div id="content-wrapper"><header><nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav></header><div class="docPage_1jis"><main class="docMainContainer_3j_A"><div class="container padding-vert--lg"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">Extending Joern</h1></header><div class="markdown"><p>Joern provides a runtime extension mechanism that allows you to
develop custom analyzers on top of the platform. Extensions are
programs for the JVM that can be written in Java, Scala or
Kotlin. They can access the Code Property Praph via a query language
and create new nodes, edges and properties via the DiffGraph
API. Moreover, they can interface with Java libraries to accomplish
different tasks, like accessing the network or writing to the file
system. Finally, even new node and edge types can be added to the
schema, and the definition of existing node and edge types can be
modified.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="installing-the-sample-extension"></a>Installing the sample extension<a aria-hidden="true" tabindex="-1" class="hash-link" href="#installing-the-sample-extension" title="Direct link to heading">#</a></h2><p>We provide a sample extension that you can use as a template. First,
make sure that dependencies are installed correctly:</p><ul><li>Joern is installed in <code>~/bin/joern</code> (see
<a href="/installation">Installation</a>)</li><li>The Scala Build Tool (SBT) in any version (via your package manager)</li></ul><p>Next, issue the following commands to install the sample extension.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/joernio/sample-extension</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cd sample-extension</span></div><div class="token-line" style="color:#393A34"><span class="token plain">./install.sh</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cd ~/bin/joern/joern-cli</span></div><div class="token-line" style="color:#393A34"><span class="token plain">./joern</span></div></div></div></div></div><p>On the joern shell, type <code>run</code>. You should see the extension in the
overview:</p><p><img src="/img/run.png" alt="Run output"></p><p>To run the extension, type <code>run.gitextension</code>. You can also
inspect/modify options passed to the plugin by typing
<code>opts.gitextension.&lt;TAB&gt;</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="importing-into-the-intellij-ide-and-running-tests"></a>Importing into the IntelliJ IDE and running tests<a aria-hidden="true" tabindex="-1" class="hash-link" href="#importing-into-the-intellij-ide-and-running-tests" title="Direct link to heading">#</a></h2><p>Joern Extensions can be developed in an IDE and the process of
importing an extension may differ slightly from IDE to IDE. The
following instructions are for IntelliJ 2020.1.1.</p><p>Choose &quot;Open or Import&quot; to import the project.</p><p><img src="/img/startscreen.png" alt="IntelliJ start screen"></p><p>Next, select the directory from the file selector. Assuming that your
IntelliJ installation has support for <code>sbt</code> installed, the import is
fully automated.</p><p><img src="/img/select.png" alt="Just select the project"></p><p>Finally, navigate to <code>src/test/scala/io/shiftleft/gitextension</code> and
click on <code>GitextentionTests</code>. You can right-click on the class or the
individual tests to run them.</p><p><img src="/img/runtests.png" alt="Right click"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="adding-dependencies"></a>Adding dependencies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-dependencies" title="Direct link to heading">#</a></h2><p>You can add dependencies by modifying the variable
<code>libraryDependencies</code> in <code>build.sbt</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">// build.sbt</span></div><div class="token-line" style="color:#393A34"><span class="token plain">name := &quot;joern-sample-extension&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ThisBuild/organization := &quot;io.joern&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">ThisBuild/scalaVersion := &quot;2.13.0&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">libraryDependencies ++= Seq(</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   // Add your dependencies here</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;org.eclipse.jgit&quot; % &quot;org.eclipse.jgit&quot; % &quot;5.7.0.202003110725-r&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;org.scalatest&quot; %% &quot;scalatest&quot; % &quot;3.1.1&quot; % Test</span></div><div class="token-line" style="color:#393A34"><span class="token plain">)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div></div></div><p>If the dependency is not shipped with joern, please also make sure to
copy it to joern&#x27;s <code>lib</code> directory on installation by editing
<code>install.sh</code>. (We may have already automated this step at the time of
reading):</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">// install.sh</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Installing jars into: ${JAR_INSTALL_DIR}&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cp target/universal/stage/lib/io.joern.joern-sample-extension-*.jar ${JAR_INSTALL_DIR}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cp target/universal/stage/lib/org.eclipse.jgit.org.eclipse.jgit* ${JAR_INSTALL_DIR}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">// Copy any jars you need to be installed for the plugin into $JAR_INSTALL_DIR</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cp target/universal/stage/lib/... ${JAR_INSTALL_DIR}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">...</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="extending-the-cpg-schema"></a>Extending the CPG schema<a aria-hidden="true" tabindex="-1" class="hash-link" href="#extending-the-cpg-schema" title="Direct link to heading">#</a></h2><p>You can make additions to the CPG schema specification by placing
<code>.json</code> files in <code>schema/src/main/resources/schema/</code>. A sample schema
extension is provided that adds an edge of type &quot;FOO&quot; that is valid
from <code>FILE</code> nodes to <code>METHOD</code> nodes.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">schema/src/main/resources/schema/ext.json</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;edgeTypes&quot; : [</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {&quot;id&quot; : 9000, &quot;name&quot;: &quot;FOO&quot;, &quot;comment&quot; : &quot;Foo edge&quot;, &quot;keys&quot;: []}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  ],</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;nodeTypes&quot; : [</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      { &quot;name&quot; : &quot;FILE&quot;, &quot;outEdges&quot; : [{&quot;edgeName&quot;: &quot;FOO&quot;, &quot;inNodes&quot;: [{&quot;name&quot;: &quot;METHOD&quot;}]}] }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  ]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></div></article></div></div><div class="col col--3"><div class="tableOfContents_tVyB"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installing-the-sample-extension" class="table-of-contents__link">Installing the sample extension</a></li><li><a href="#importing-into-the-intellij-ide-and-running-tests" class="table-of-contents__link">Importing into the IntelliJ IDE and running tests</a></li><li><a href="#adding-dependencies" class="table-of-contents__link">Adding dependencies</a></li><li><a href="#extending-the-cpg-schema" class="table-of-contents__link">Extending the CPG schema</a></li></ul></div></div></div></div></main></div></div><div id="right-spacer"></div></div></div></div>
<script src="/styles.63ef370e.js"></script>
<script src="/runtime~main.a8443992.js"></script>
<script src="/main.4748f629.js"></script>
<script src="/1.e1eda06e.js"></script>
<script src="/39.dca14509.js"></script>
<script src="/1be78505.90797e98.js"></script>
<script src="/ec1ed54d.6e92f1ec.js"></script>
<script src="/a4b43bd0.b8428a97.js"></script>
</body>
</html>
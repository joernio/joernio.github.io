(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{103:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return l})),t.d(n,"metadata",(function(){return i})),t.d(n,"toc",(function(){return p})),t.d(n,"default",(function(){return s}));var r=t(3),a=t(7),o=(t(0),t(109)),l={id:"exporting",title:"Exporting Graphs"},i={unversionedId:"exporting",id:"exporting",isDocsHomePage:!1,title:"Exporting Graphs",description:"Joern is used in academic research as a source for",source:"@site/docs/export.md",slug:"/exporting",permalink:"/exporting",editUrl:"https://github.com/joernio/website/edit/master/docs.joern.io/docs/export.md",version:"current",sidebar:"docs",previous:{title:"Joern Scan",permalink:"/scan"},next:{title:"Server",permalink:"/server"}},p=[{value:"The command line tool <code>joern-export</code>",id:"the-command-line-tool-joern-export",children:[]},{value:"Plotting and Exporting on the Joern Console",id:"plotting-and-exporting-on-the-joern-console",children:[{value:"Example",id:"example",children:[]}]},{value:"Dumping representations for all functions from the shell",id:"dumping-representations-for-all-functions-from-the-shell",children:[]},{value:"References",id:"references",children:[]}],c={toc:p};function s(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Joern is used in academic research as a source for\nintermediate graph representations of code, particularly in machine\nlearning and vulnerability discovery applications [e.g., ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"#references"}),"1,2,3,4,5"),"]. To support\nthis use-case, Joern provides both plotting capabilities in the\ninteractive console as well as the ",Object(o.b)("inlineCode",{parentName:"p"},"joern-export")," command line\nutility."),Object(o.b)("p",null,"In summary, Joern can create the following graph representations for\nC/C++ code:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Abstract Syntax Trees (AST)"),Object(o.b)("li",{parentName:"ul"},"Control Flow Graphs (CFG)"),Object(o.b)("li",{parentName:"ul"},"Control Dependence Graphs (CDG)"),Object(o.b)("li",{parentName:"ul"},"Data Dependence Graphs (DDG)"),Object(o.b)("li",{parentName:"ul"},"Program Dependence graphs (PDG)"),Object(o.b)("li",{parentName:"ul"},"Code Property Graphs\n(",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://www.sec.cs.tu-bs.de/pubs/2014-ieeesp.pdf"}),"CPG14"),")"),Object(o.b)("li",{parentName:"ul"},"Entire graph, i.e. convert to a different graph format (ALL)")),Object(o.b)("h2",{id:"the-command-line-tool-joern-export"},"The command line tool ",Object(o.b)("inlineCode",{parentName:"h2"},"joern-export")),Object(o.b)("p",null,"All of these representations can be plotted and exported into the\ngraphviz dot format to enable processing with third party tools or via\nexternal scripts."),Object(o.b)("p",null,"To parse the code in ",Object(o.b)("inlineCode",{parentName:"p"},"/src/directory")," and dump Program Dependence\nGraphs for all methods into the directory ",Object(o.b)("inlineCode",{parentName:"p"},"outdir"),", you can run the\nfollowing commands on the system shell:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"joern-parse /src/directory\njoern-export --repr pdg --out outdir\n")),Object(o.b)("p",null,"You can also export the entire graph into a ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://neo4j.com/docs/operations-manual/current/tools/neo4j-admin/neo4j-admin-import/"}),"neo4j csv format")," (along with instructions on how to import it into a running neo4j instance), ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"http://graphml.graphdrawing.org/primer/graphml-primer.html"}),"graphml"),", ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://tinkerpop.apache.org/docs/3.4.1/dev/io/#graphson-3d0"}),"graphson")," or ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.graphviz.org/doc/info/lang.html"}),"graphviz dot"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"./joern-export --repr=all --format=neo4jcsv\n./joern-export --repr=all --format=graphml\n./joern-export --repr=all --format=graphson\n./joern-export --repr=all --format=dot\n")),Object(o.b)("p",null,"For a complete overview of options, run ",Object(o.b)("inlineCode",{parentName:"p"},"joern-export --help"),"."),Object(o.b)("h2",{id:"plotting-and-exporting-on-the-joern-console"},"Plotting and Exporting on the Joern Console"),Object(o.b)("p",null,"If you would like to explore graph representations interactively, you\ncan do so on the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/shell"}),"Joern shell"),". To this end, we define\nthe following steps on ",Object(o.b)("inlineCode",{parentName:"p"},"method")," nodes to dump representations in dot\nformat."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"cpg.method($name).dotAst.l // output AST in dot format\ncpg.method($name).dotCfg.l // output CFG in dot format\n...\ncpg.method($name).dotCpg14.l // output CPG'14 in dot format\n")),Object(o.b)("p",null,"You can also plot and view representations using the following\nqueries:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"cpg.method($name).plotDotAst // plot AST\ncpg.method($name).ploDotCfg // plot CFG\n...\ncpg.method($name).plotDotCpg14 // plot CPG'14\n")),Object(o.b)("p",null,"Note that the ",Object(o.b)("inlineCode",{parentName:"p"},"ossdataflow")," layer needs to have been calculated for\nthe source CPG via ",Object(o.b)("inlineCode",{parentName:"p"},"run.ossdataflow"),"."),Object(o.b)("h3",{id:"example"},"Example"),Object(o.b)("p",null,"Generate the CPG along with the data flow layer for a sample function\nnamed ",Object(o.b)("inlineCode",{parentName:"p"},"myfunc"),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),'joern> importCode.c.fromString( """\n           int myfunc(int b) {\n             int a = 42;\n             if (b > 10) {\n                foo(a)\n             }\n             bar(a);\n           }\n           """\n       ) \n\njoern> run.ossdataflow\n')),Object(o.b)("p",null,"You can now plot the AST as follows:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),'joern> cpg.method("myfunc").plotDotAst \n')),Object(o.b)("p",null,"You can obtain the dot representation of the AST as well:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),'joern> cpg.method("myfunc").dotAst.l\nres4: List[String] = List(\n  """digraph myfunc {  \n"1000102" [label = "(METHOD,myfunc)" ]\n"1000103" [label = "(PARAM,int b)" ]\n"1000104" [label = "(BLOCK,,)" ]\n"1000105" [label = "(LOCAL,a: int)" ]\n"1000106" [label = "(<operator>.assignment,a = 42)" ]\n"1000107" [label = "(IDENTIFIER,a,a = 42)" ]\n"1000108" [label = "(LITERAL,42,a = 42)" ]\n"1000109" [label = "(CONTROL_STRUCTURE,if (b > 10),if (b > 10))" ]\n"1000110" [label = "(<operator>.greaterThan,b > 10)" ]\n"1000111" [label = "(IDENTIFIER,b,b > 10)" ]\n"1000112" [label = "(LITERAL,10,b > 10)" ]\n"1000113" [label = "(BLOCK,,)" ]\n"1000114" [label = "(bar,bar(a))" ]\n"1000115" [label = "(IDENTIFIER,a,bar(a))" ]\n"1000116" [label = "(METHOD_RETURN,int)" ]\n  "1000102" -> "1000103"  \n  "1000102" -> "1000104"  \n  "1000102" -> "1000116"  \n  "1000104" -> "1000105"  \n  "1000104" -> "1000106"  \n  "1000104" -> "1000109"  \n  "1000104" -> "1000114"  \n  "1000106" -> "1000107"  \n  "1000106" -> "1000108"  \n  "1000109" -> "1000110"  \n  "1000109" -> "1000113"  \n  "1000110" -> "1000111"  \n  "1000110" -> "1000112"  \n  "1000114" -> "1000115"  \n}\n"""\n)\n')),Object(o.b)("h2",{id:"dumping-representations-for-all-functions-from-the-shell"},"Dumping representations for all functions from the shell"),Object(o.b)("p",null,"You can also dump all representations into the directory ",Object(o.b)("inlineCode",{parentName:"p"},"out")," using"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"run.dumpast\nrun.dumpcfg\n...\nrun.dumpcpg14\n")),Object(o.b)("h2",{id:"references"},"References"),Object(o.b)("p",null,"Research that employs Joern as an extraction tool for intermediate\nrepresentations of code:"),Object(o.b)("p",null,"(1) ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://papers.nips.cc/paper/9209-devign-effective-vulnerability-identification-by-learning-comprehensive-program-semantics-via-graph-neural-networks.pdf"}),"Devign: Effective Vulnerability Identification by Learning\nComprehensive Program Semantics via Graph Neural Networks, Zhou et al.,\nNIPS'19")),Object(o.b)("p",null,"(2) ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.cs.drexel.edu/~greenie/stylometry-esorics.pdf"}),"Source Code Authorship Attribution using LongShort-Term Memory\nBased Networks, Alsulami et al., ESORICS'17")),Object(o.b)("p",null,"(3)",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"http://www.cs.utsa.edu/~shxu/socs/VulPecker.pdf"}),"VulPecker: an automated vulnerability detection system based on\ncode similarity analysis, Li et al.,\nACSAC'16")),Object(o.b)("p",null,"(4) ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://content.sciendo.com/view/journals/popets/2019/3/article-p389.xml?language=en"}),"Git blame who?: Stylistic authorship attribution of small,\nincomplete source code fragments, Dauber et al.,\nPETS-19/3")),Object(o.b)("p",null,"(5) ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://machiry.github.io/files/spider.pdf"}),"SPIDER: Enabling Fast Patch Propagation In Related Software\nRepositories, Machiry et al., S&P'20")))}s.isMDXComponent=!0},109:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return d}));var r=t(0),a=t.n(r);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=a.a.createContext({}),s=function(e){var n=a.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},b=function(e){var n=s(e.components);return a.a.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},m=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),b=s(t),m=r,d=b["".concat(l,".").concat(m)]||b[m]||u[m]||o;return t?a.a.createElement(d,i(i({ref:n},c),{},{components:t})):a.a.createElement(d,i({ref:n},c))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,l=new Array(o);l[0]=m;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=t[c];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);
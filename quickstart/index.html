<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.55">
<link rel="stylesheet" href="react-image-lightbox/style.css"><title data-react-helmet="true">Quickstart | Joern Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Quickstart | Joern Documentation"><meta data-react-helmet="true" name="description" content="Joern is a command-line tools for static code analysis. Joern can"><meta data-react-helmet="true" property="og:description" content="Joern is a command-line tools for static code analysis. Joern can"><meta data-react-helmet="true" property="og:url" content="https://docs.joern.io/quickstart"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link data-react-helmet="true" rel="shortcut icon" href="/img/website-icon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.joern.io/quickstart"><link rel="stylesheet" href="/styles.d76b5722.css">
<link rel="preload" href="/styles.63ef370e.js" as="script">
<link rel="preload" href="/runtime~main.a8443992.js" as="script">
<link rel="preload" href="/main.8f3d9bde.js" as="script">
<link rel="preload" href="/1.e1eda06e.js" as="script">
<link rel="preload" href="/39.dca14509.js" as="script">
<link rel="preload" href="/1be78505.90797e98.js" as="script">
<link rel="preload" href="/ec1ed54d.6e92f1ec.js" as="script">
<link rel="preload" href="/74876495.92c836d3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):(e.matches,t("dark"))}()</script><div id="__docusaurus">
<div class="main-wrapper"><div id="docs" class="docPage_1jis"><div id="sidebar"><div class="docSidebarContainer_1kjN"><div align="center" id="logo"><a href="https://joern.io"><img width="40%" src="/img/logo.svg"></a></div><div class="sidebar_25T_"><div class="menu menu_1e9D"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/home">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" href="/shell">Interactive Shell</a></li><li class="menu__list-item"><a class="menu__link" href="/interpreter">Interpreter</a></li><li class="menu__list-item"><a class="menu__link" href="/exporting">Exporting Graphs</a></li><li class="menu__list-item"><a class="menu__link" href="/server">Server</a></li><li class="menu__list-item"><a class="menu__link" href="/organizing-projects">Workspace</a></li><li class="menu__list-item"><a class="menu__link" href="/code-property-graph">Code Property Graph</a></li><li class="menu__list-item"><a class="menu__link" href="/traversal-basics">Traversal Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/c-syntaxtree">Syntax-Tree Queries</a></li><li class="menu__list-item"><a class="menu__link" href="/extensions">Extending Joern</a></li><li class="menu__list-item"><a class="menu__link" href="/glossary">Glossary</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CPGQL Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/reference-card">Reference Card</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/node-type-steps">Node-Type Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/filter-steps">Filter Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/core-steps">Core Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/repeat-steps">Repeat Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/complex-steps">Complex Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/execution-directives">Execution Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/augmentation-directives">Augmentation Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/help-directive">Help Directive</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/calls">Calls</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/upgrade-guides">Upgrade guides</a></li></ul></div></div></div></div><div id="content-wrapper"><header><nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav></header><div class="docPage_1jis"><main class="docMainContainer_3j_A"><div class="container padding-vert--lg"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">Quickstart</h1></header><div class="markdown"><p>Joern is a command-line tools for static code analysis. Joern can
help you find and correct security vulnerabilities in programs with
hundreds of thousands of lines of code, including flaws that are
difficult to detect with fuzzing. It includes an interactive shell and
automation capabilities centered around Code Property Graphs.</p><p>This article introduces you to the basics of working with Joern. You
learn how to create and modify Code Property Graphs, how to query them
and about organisational commands. If you have not yet installed
Joern, you can do so by following <a href="/installation">these instructions</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="obtaining-the-sample-program"></a>Obtaining the Sample Program<a aria-hidden="true" tabindex="-1" class="hash-link" href="#obtaining-the-sample-program" title="Direct link to heading">#</a></h2><p>Before you start Joern, you should have a program ready to
analyze. Clone the following git repository which contains a simple
program named <code>X42</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone git@github.com:ShiftLeftSecurity/x42.git</span></div></div></div></div></div><p>Let us start with a problem statement. Show - without running the
program - that an input exists for which <code>X42</code> writes a string to
standard error (STDERR).</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// X42.c</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;It depends!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;What is the meaning of life?\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="starting-joerns-interactive-shell"></a>Starting Joern&#x27;s Interactive Shell<a aria-hidden="true" tabindex="-1" class="hash-link" href="#starting-joerns-interactive-shell" title="Direct link to heading">#</a></h2><p>Launch Joern in your shell:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ joern</span></div></div></div></div></div><p>A console session will start and you will see a prompt:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span></div></div></div></div></div><p>The prompt you are looking at is the prompt of a Scala-based REPL. If
you have no experience with Scala or read-eval-print-loops, don&#x27;t
worry, you can accomplish a lot with Joern by focusing only on what
its commands allow you to do. If you <em>are</em> familiar with Scala and
REPLs, you may be pleasantly surprised at the flexibility it provides
you with.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="importing-the-code"></a>Importing the Code<a aria-hidden="true" tabindex="-1" class="hash-link" href="#importing-the-code" title="Direct link to heading">#</a></h2><p>We create a Code Property Graph for the <code>X42</code> program using the
command <code>importCode</code>, which requires the path to the source code to be
passed as a first argument, and a project name as a second
argument. In particular, <code>importCode</code> creates a new project directory
and stores a binary representation of the Code Property Graph in it.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">importCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inputPath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;./x42/c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> projectName</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;x42-c&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Creating</span><span class="token plain"> project `x42</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">c` </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> code at `x42</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">c`</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> output omitted</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Cpg</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">codepropertygraph</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Cpg</span><span class="token annotation punctuation" style="color:#393A34">@31ed46c5</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you see an error and a return value of <code>None</code>, you have probably pointed Joern to the wrong input path for the directory containing the source code for the sample project.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="querying-the-code-property-graph"></a>Querying the Code Property Graph<a aria-hidden="true" tabindex="-1" class="hash-link" href="#querying-the-code-property-graph" title="Direct link to heading">#</a></h2><p>You are ready to analyze your first program using Joern and the Code
Property Graph. Code analysis in Joern is done using the query
language, a domain-specific language designed specifically for work
with the Code Property Graph. It contains practical representations of
the various nodes found in the Code Property Graph, and useful
functions for querying their properties and relationships between each
other. The top-level entry point into a Code Property Graph loaded in
memory, and the root object of the query Language is <code>cpg</code>. If you
evaluate <code>cpg</code> at the prompt, the output is underwhelming:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Cpg</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">codepropertygraph</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Cpg</span><span class="token annotation punctuation" style="color:#393A34">@cb0d5241</span></div></div></div></div></div><p>Rest assured, a lot is hidden behind that simple statement. You will
discover the full set of commands in time, but for now, you should
learn a helpful Joern trick: <code>TAB</code>-completion. In the Joern prompt,
type <code>cpg.</code>, do not press <code>ENTER</code>, but instead press <code>TAB</code>. You will
see a list of available functions <code>cpg</code> supports:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">all                            comment                        finding                        local                          newArgumentDescriptorSource    newReturnSource                runScript                      types</span></div><div class="token-line" style="color:#393A34"><span class="token plain">annotation                     configfile                     flow                           member                         newArgumentSink                newTagForMethodsWithFullName   scalaGraph                     write</span></div><div class="token-line" style="color:#393A34"><span class="token plain">argument                       cpg                            graph                          metaData                       newArgumentSource              newTagForParameter             sensitiveType</span></div><div class="token-line" style="color:#393A34"><span class="token plain">arithmetic                     dependency                     help                           method                         newExposedParameterSink        newTagForParameterWithIndex    sensitiveVariable</span></div><div class="token-line" style="color:#393A34"><span class="token plain">assignment                     dom                            id                             methodRef                      newExposedParameterSource      newTagForParameterWithIndexes  sink</span></div><div class="token-line" style="color:#393A34"><span class="token plain">blacklist                      exposedMethod                  identifier                     methodReturn                   newLiteralSource               packagePrefix                  source</span></div><div class="token-line" style="color:#393A34"><span class="token plain">call                           exposedOutputParameter         ioFlow                         namespace                      newMethodSummary               parameter                      tag</span></div><div class="token-line" style="color:#393A34"><span class="token plain">callChain                      exposedParameter               jsp                            namespaceBlock                 newReturnDescriptorSource      read                           transform</span></div><div class="token-line" style="color:#393A34"><span class="token plain">close                          file                           literal                        newArgumentDescriptorSink      newReturnSink                  returns                        typeDecl</span></div></div></div></div></div><p>TAB-completion is available for all query language directives, and for
top-level commands. For more descriptive assistance, use the <code>help</code>
command, like so:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> help</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpg </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res3</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Upon</span><span class="token plain"> importing code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a project is created that holds an intermediate</span></div><div class="token-line" style="color:#393A34"><span class="token plain">representation called `</span><span class="token class-name">Code</span><span class="token plain"> </span><span class="token class-name">Property</span><span class="token plain"> </span><span class="token class-name">Graph</span><span class="token plain">`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token class-name">This</span><span class="token plain"> graph is a composition of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">low</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">level program representations such as </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> syntax trees and control flow</span></div><div class="token-line" style="color:#393A34"><span class="token plain">graphs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> but it can be arbitrarily extended </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> hold any information relevant in</span></div><div class="token-line" style="color:#393A34"><span class="token plain">your audit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> information about HTTP entry points</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">IO</span><span class="token plain"> routines</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> information flows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">or locations of vulnerable code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token class-name">Think</span><span class="token plain"> of </span><span class="token class-name">Joern</span><span class="token plain"> as a CPG editor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">In</span><span class="token plain"> practice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> `cpg` is the root object of the query language</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> that is</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> all query</span></div><div class="token-line" style="color:#393A34"><span class="token plain">language constructs can be invoked starting from `cpg`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token class-name">For</span><span class="token plain"> exanple</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">`cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l` lists all methods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> `cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">finding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l` lists all findings of</span></div><div class="token-line" style="color:#393A34"><span class="token plain">potentially vulnerable code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot;</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="solving-the-challenge"></a>Solving the Challenge<a aria-hidden="true" tabindex="-1" class="hash-link" href="#solving-the-challenge" title="Direct link to heading">#</a></h2><p>Now that we have a good set of basic commands, and a Code Property
Graph loaded in memory, let us return to our <code>X42</code> program and the
problem we want to solve using Joern.
To reiterate, the problem statement is <em>Show that an input exists for
which the X42 program always writes a string to STDERR</em>. And this is
the <code>X42</code> program:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// X42.c</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;It depends!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;What is the meaning of life?\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>There are two parts in the problem statement: 1. <em>does the program
write anything to STDERR?</em>, and 2. _if there is a call writing to
STDERR, is it conditional on a value passed in as argument to the
<code>X42</code> program?</p><p>Joern makes answering both questions easy. To answer the first one,
whether the program writes anything to STDERR, we can search for nodes
of type <code>CALL</code> in the graph, then use the <code>argument</code> step to only
select those calls which have connections to nodes of type <code>ARGUMENT</code>,
followed by the <code>code(&quot;stderr&quot;)</code> property filter step which selects only
those nodes that have the string <code>stderr</code> as the value of their <code>CODE</code>
property. We find exactly one:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argument</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;stderr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res4</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Call</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fprintf(stderr, \&quot;It depends!\\n\&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fprintf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    methodInstFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    methodFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fprintf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dispatchType </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;STATIC_DISPATCH&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    signature </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TODO assignment signature&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    typeFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ANY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dynamicTypeHintFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    resolved </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>With this query we have proven the first part of our problem statement correct, there is a place in the <code>X42</code> program that writes to STDERR. Let us move to the second part, the check whether the call that writes something to STDERR is conditional on a value passed as input to the <code>X42</code> program. Since we are analyzing a program written in <code>C</code>, we will search the Code Property Graph for the conventional <code>argc</code> or <code>argv</code> parameters of the <code>main</code> function as the input that potentially triggers the call which writes to STDERR.</p><p>Using the query from the previous step, we can use the <code>astParent</code> construct to find out more about the surroundings around the <code>fprintf</code> call by moving up in the hierarchy of the abstract syntax tree that is part of the Code Property Graph. Moving up one level in the AST hierarchy gives us a block; not very helpful:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argument</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;stderr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astParent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res5</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">AstNode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Block</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    typeFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;void&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dynamicTypeHintFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">46</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Another two layers up gives us an if statement, much better:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argument</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;stderr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astParent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astParent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astParent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res6</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">AstNode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">ControlStructure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;if (argc &gt; 1 &amp;&amp; strcmp(argv[1], \&quot;42\&quot;) == 0)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    parserTypeName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IfStatement&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>The <code>CODE</code> property of the <code>CONTROL_STRUCTURE</code> node you just found proves the second part of our problem statement correct, the call that writes to STDERR is conditional on <code>argc</code> and <code>argv</code>. Hence, the whole problem statement is correct.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="closing-the-project"></a>Closing the Project<a aria-hidden="true" tabindex="-1" class="hash-link" href="#closing-the-project" title="Direct link to heading">#</a></h2><p>Now that we&#x27;ve finished the analysis, let us close the project, which also unloads the Code Property Graph from memory. You do not have to worry about losing any data, because it will remain on disk in the <code>x42-c</code> project you created earlier with <code>importCode</code>. Close the project using the aptly-named <code>close</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> close </span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">01.752</span><span class="token plain"> WARN clearing </span><span class="token number" style="color:#36acaa">105</span><span class="token plain"> references </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> may take some time</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">01.756</span><span class="token plain"> WARN cleared all clearable references</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res7</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workspacehandling</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Project</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ProjectFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/home/user/x42/c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;x42-c&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">home</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">user</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">joern</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">workspace</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">x42</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>As a final step, exit Joern:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> exit</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Bye</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Would</span><span class="token plain"> you like </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> save changes</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">N</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">y</span></div><div class="token-line" style="color:#393A34"><span class="token plain">saving</span><span class="token punctuation" style="color:#393A34">.</span></div></div></div></div></div><p>Congratulations, you have succesfully queried your first  Code
Property Graph using Joern and its query language. In subsequent
articles, you will learn the more advanced features of Joern and also
how to use it to find your first real-world vulnerability.</p></div></article></div></div><div class="col col--3"><div class="tableOfContents_tVyB"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#obtaining-the-sample-program" class="table-of-contents__link">Obtaining the Sample Program</a></li><li><a href="#starting-joerns-interactive-shell" class="table-of-contents__link">Starting Joern&#39;s Interactive Shell</a></li><li><a href="#importing-the-code" class="table-of-contents__link">Importing the Code</a></li><li><a href="#querying-the-code-property-graph" class="table-of-contents__link">Querying the Code Property Graph</a></li><li><a href="#solving-the-challenge" class="table-of-contents__link">Solving the Challenge</a></li><li><a href="#closing-the-project" class="table-of-contents__link">Closing the Project</a></li></ul></div></div></div></div></main></div></div><div id="right-spacer"></div></div></div></div>
<script src="/styles.63ef370e.js"></script>
<script src="/runtime~main.a8443992.js"></script>
<script src="/main.8f3d9bde.js"></script>
<script src="/1.e1eda06e.js"></script>
<script src="/39.dca14509.js"></script>
<script src="/1be78505.90797e98.js"></script>
<script src="/ec1ed54d.6e92f1ec.js"></script>
<script src="/74876495.92c836d3.js"></script>
</body>
</html>
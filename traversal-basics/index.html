<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.55">
<link rel="stylesheet" href="react-image-lightbox/style.css"><title data-react-helmet="true">Traversal Basics | Joern Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Traversal Basics | Joern Documentation"><meta data-react-helmet="true" name="description" content="Joern helps you discover security vulnerabilities by executing graph"><meta data-react-helmet="true" property="og:description" content="Joern helps you discover security vulnerabilities by executing graph"><meta data-react-helmet="true" property="og:url" content="https://joernio.github.io/traversal-basics"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link data-react-helmet="true" rel="shortcut icon" href="/img/website-icon.png"><link data-react-helmet="true" rel="canonical" href="https://joernio.github.io/traversal-basics"><link rel="stylesheet" href="/styles.d76b5722.css">
<link rel="preload" href="/styles.63ef370e.js" as="script">
<link rel="preload" href="/runtime~main.a31b6222.js" as="script">
<link rel="preload" href="/main.a1a9c2ad.js" as="script">
<link rel="preload" href="/1.e1eda06e.js" as="script">
<link rel="preload" href="/39.4197c376.js" as="script">
<link rel="preload" href="/1be78505.cc91c0fc.js" as="script">
<link rel="preload" href="/ec1ed54d.6e92f1ec.js" as="script">
<link rel="preload" href="/8b5d902e.9e1d82bf.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):(e.matches,t("dark"))}()</script><div id="__docusaurus">
<div class="main-wrapper"><div id="docs" class="docPage_1jis"><div id="sidebar"><div class="docSidebarContainer_1kjN"><div align="center" id="logo"><a href="https://joern.io"><img width="40%" src="/img/logo.svg"></a></div><div class="sidebar_25T_"><div class="menu menu_1e9D"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/home">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" href="/shell">Interactive Shell</a></li><li class="menu__list-item"><a class="menu__link" href="/interpreter">Interpreter</a></li><li class="menu__list-item"><a class="menu__link" href="/exporting">Exporting Graphs</a></li><li class="menu__list-item"><a class="menu__link" href="/server">Server</a></li><li class="menu__list-item"><a class="menu__link" href="/organizing-projects">Workspace</a></li><li class="menu__list-item"><a class="menu__link" href="/code-property-graph">Code Property Graph</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/traversal-basics">Traversal Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/c-syntaxtree">Syntax-Tree Queries</a></li><li class="menu__list-item"><a class="menu__link" href="/extensions">Extending Joern</a></li><li class="menu__list-item"><a class="menu__link" href="/glossary">Glossary</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CPGQL Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/reference-card">Reference Card</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/node-type-steps">Node-Type Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/filter-steps">Filter Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/core-steps">Core Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/repeat-steps">Repeat Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/complex-steps">Complex Steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/execution-directives">Execution Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/augmentation-directives">Augmentation Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/help-directive">Help Directive</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cpgql/calls">Calls</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/upgrade-guides">Upgrade guides</a></li></ul></div></div></div></div><div id="content-wrapper"><header><nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav></header><div class="docPage_1jis"><main class="docMainContainer_3j_A"><div class="container padding-vert--lg"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">Traversal Basics</h1></header><div class="markdown"><p>Joern helps you discover security vulnerabilities by executing graph
traversals on the <a href="/code-property-graph">Code Property
Graph</a>. A traversal is formulated
as an <em>Joern Query</em>, or <em>query</em> for short. In this article, you will learn about the different components that make up queries.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-anatomy-of-an-joern-query"></a>The Anatomy of an Joern Query<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-anatomy-of-an-joern-query" title="Direct link to heading">#</a></h3><p>A query consists of the following components:</p><ol><li>A <em>Root Object</em>, which is the reference to the <em>Code Property Graph</em> being queried</li><li>Zero or more <em>Node-Type Steps</em>, which are atomic traversals to all nodes of a given type</li><li>Zero or more <em>Filter Steps</em>, <em>Map Steps</em> or <em>Repeat Steps</em></li><li>Zero or more <em>Property Directives</em>, which reference the properties of nodes in a traversal</li><li>Zero or more <em>Execution Directives</em>, which execute a traversal and return results in a specific format</li><li>Zero or more <em>Augmentation Directives</em>, which extend a Code Property Graph with new nodes, properties, or edges</li></ol><p>Finally, components 2-7 can be combined into Complex Steps in the same way basic expressions of a programming language can be combined into complex expressions.</p><p>As an example, the query</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">cpg.method.name.toList</span></div></div></div></div></div><p>returns all names of methods present in a Code Property Graph and can be dissected as follows: <code>cpg</code> is the root object, <code>method</code> is a node-type step which references all <code>METHOD</code> nodes, <code>name</code> is a property directive which references the <code>NAME</code> property of those <code>METHOD</code> nodes, and <code>toList</code> is an execution directive which executes the traversal and returns the result as a list.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="importing-a-sample-project"></a>Importing a Sample Project<a aria-hidden="true" tabindex="-1" class="hash-link" href="#importing-a-sample-project" title="Direct link to heading">#</a></h3><p>Before we go into the details of these components, let us import a sample program. Clone the following git repository which contains the <em>Java</em> implementation of a simple program named <code>X42</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone git@github.com:ShiftLeftSecurity/x42.git</span></div></div></div></div></div><p>Start Joern and specify a 4GB JVM heap size using the <code>JAVA_OPTS</code> environment variable:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">JAVA_OPTS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;-Xmx4g&#x27;</span><span class="token plain"> joern</span></div></div></div></div></div><p>Then create a <a href="/Joern/organizing-projects">Project</a> from the JAR file of the <code>X42</code> program using the <code>importCode</code> <a href="/Joern/top-level-commands">top-level command</a>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">importCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./x42/c/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;x42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Creating</span><span class="token plain"> project `x42` </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> code at `x42</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">c</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">`</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> output omitted</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res0</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Cpg</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">codepropertygraph</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Cpg</span><span class="token annotation punctuation" style="color:#393A34">@31ed46c5</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="a-first-traversal"></a>A First Traversal<a aria-hidden="true" tabindex="-1" class="hash-link" href="#a-first-traversal" title="Direct link to heading">#</a></h2><p>For our first traversal, our objective is to determine the <code>LANGUAGE</code> property of the <code>METADATA</code> node in the Code Property Graph of the <code>X42</code> program. At the Joern prompt, type <code>cpg</code> and press <code>ENTER</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Cpg</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shiftleft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">codepropertygraph</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Cpg</span><span class="token annotation punctuation" style="color:#393A34">@ab90fdab</span></div></div></div></div></div><p>The executed query consists only of the root object <code>cpg</code>. The return value of that execution is a reference to the Code Property Graph and  the reference itself is suffixed by a hexadecimal string (in this case <code>@ab90fdab</code>) that uniquely identifies it. We proceed to add the <code>metaData</code> node-type step to the query. This step represents a traversal to all nodes of type <code>METADATA</code> (of which there is only one):</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metaData </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Traversal</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">MetaData</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Traversal</span></div></div></div></div></div><p>Note that the result is not the content of the <code>METADATA</code> node, but a traversal that visits the <code>METADATA</code> node. In other words, Traversals are lazyly evaluated - you can compose them and at some later point execute them, as we will see. </p><p>This behaviour points to the ephemeral nature of queries: each query is separate from the other, and Joern holds distinct in-memory representations for them. The only object shared between queries is the root object (<code>cpg</code>).</p><p>Traversals are executed - as opposed to just to being held in memory - using execution directives such as <code>toList</code>. The directive <code>toList</code> executes the traversal and returns results in a list: </p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metaData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res3</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">MetaData</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">MetaData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    language </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    version </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    overlays </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;semanticcpg&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    policyDirectories </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spid </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>In the result of this query, we already see the <code>LANGUAGE</code> field and that it is <code>C</code>. For the sake of completeness and to illustrate property directives, let us add the property directive <code>language</code> to the query. Property directives provide access to individual node properties. Each node-type step can be combined with different property directives, and they usually match the properties defined on the node type represented by the node-type step:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metaData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">language</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res4</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">AnyRef</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span></div></div></div></div></div><p>With this last query, we have achieved our goal of executing a traversal which returns the <code>LANGUAGE</code> property of the <code>METADATA</code> node of the <code>X42</code> program.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="node-type-steps"></a>Node-Type Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#node-type-steps" title="Direct link to heading">#</a></h3><p>Node-Type Steps are atomic traversals that represent traversals to nodes of a given type. Each node-type step comes with distinct <em>Property Directives</em> to access the properties of the nodes they represent. Let us revisit the source code of the <code>x42</code> program to illustrate node-type steps.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// X42.c</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;It depends!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;What is the meaning of life?\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>A commonly used node-type step is <code>method</code>, which represents a traversal to all nodes of type <code>METHOD</code>. <code>METHOD</code> nodes represent declarations of methods, functions or procedures in programs, and one of their properties is <code>NAME</code>. All names of all method nodes can thus be determined as follows:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res4</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.logicalAnd&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;strcmp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.equals&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;printf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;fprintf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;exit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.greaterThan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.indirectIndexAccess&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>The number of <code>METHOD</code> nodes may surprise you, given that the program only defines the single method <code>main</code> explicitly. The Code Property Graph, however, also includes method nodes for all methods invoked by the code. Moreover, built-in operators are modeled as methods, one decision made to enable language-agnostic analysis.</p><p>We will look into the details of node-type steps in a different article. For now, it is sufficient to know that Joern offers these steps for all common node types: <code>method</code>, <code>call</code>, <code>argument</code>, <code>parameter</code>, <code>metaData</code>, <code>local</code>, <code>literal</code>, <code>types</code>, <code>returns</code>, <code>identifier</code>, <code>namespace</code>, <code>namespaceBlock</code>, <code>methodReturn</code>, <code>typeDecl</code>, <code>member</code>, <code>methodRef</code>, <code>file</code>, <code>comment</code>, <code>tag</code> and the generic <code>all</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="filter-steps"></a>Filter Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#filter-steps" title="Direct link to heading">#</a></h3><p><em>Filter Steps</em> are atomic traversals that filter nodes according to given criteria. The most common filter step is aptly-named <code>filter</code>,  which continues the traversal in the step it suffixes for all nodes which pass its criterion. Its criterion is represented by a lamba function which has access to the node of the previous step and returns a boolean.  Continuing with the previous example, let us execute a query which returns all <code>METHOD</code> nodes of the Code Property Graph for <code>X42</code>, but only if their <code>IS_EXTERNAL</code> property is set to <code>false</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isExternal </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res11</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Disecting this query, we have <code>cpg</code> as the root object, a node-type step <code>method</code> which returns all nodes of type <code>METHOD</code>, a filter step <code>where(_.isExternal == false)</code> which continues the traversal only for nodes which have their <code>IS_EXTERNAL</code> property set to <code>false</code> (with <code>_</code> referencing the individual nodes, and <code>isExternal</code> a property directive which accesses their <code>IS_EXTERNAL</code> property), followed by  a property directive <code>name</code> which returns the values of the <code>NAME</code> property of the nodes that passed the <em>Filter Step</em>, and finally an <em>Execution Directive</em> <code>toList</code> which executes the traversal and returns the results in a list.</p><p>A shorter version of a query which returns the same results as the one above can be written using a <em>Property-Filter Step</em>. Property-filter steps are <em>Filter Steps</em> which continue the traversal only for nodes which have a specific value in the property the <em>Property Filter Step</em> refers to:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isExternal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res11</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Disecting the query again, <code>cpg</code> is the root object, <code>method</code> is a node-type step, <code>isExternal(false)</code> is a property-filter step that filters for nodes which have <code>false</code> as the value of their <code>IS_EXTERNAL</code> property, <code>name</code> is a property directive, and <code>toList</code> is the execution directive you are already familiar with.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Be careful not to mix up property directives with property-filter steps, they look awfully similar.
Consider that:</p><p>a) <code>cpg.method.isExternal(true).name.toList</code> returns all <code>METHOD</code> nodes which have the <code>IS_EXTERNAL</code> property set to <code>true</code> (in this case, 10 results)</p><p>b) <code>cpg.method.isExternal.toList</code> returns the value of the <code>IS_EXTERNAL</code> property for all <code>METHOD</code> nodes in the graph (12 results)</p><p>c) <code>cpg.method.isExternal.name.toList</code> is an invalid query which will not execute</p></div></div><p>A final <em>Filter Step</em> we will look at is named <code>where</code>. Unlike <code>filter</code>, this doesn&#x27;t take a simple predicate <code>A =&gt; Boolean</code>, but instead takes a <code>Traversal[A] =&gt; Traversal[_]</code>. I.e. you supply a traversal which will be executed at the current position. The resulting Traversal will preserves elements if the provided traversal has <em>at least one</em> result. The previous query that used a <em>Property Filter Step</em> can be re-written using <code>where</code> like so:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">where</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isExternal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res24</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Maybe not particulary useful-seeming given this specific example, but keep it in the back of your head, because <code>filter</code> is a handy tool to have in the toolbox. Next up, <em>Map Steps</em>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="map-steps"></a>Map Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#map-steps" title="Direct link to heading">#</a></h3><p><em>Map Steps</em> are traversals that map a set of nodes into a different form given a function. <em>Map Steps</em> are a powerful mechanism when you need to transform results to fit your specifics. For example, say you&#x27;d like to return both the <code>IS_EXTERNAL</code> and the <code>NAME</code> properties of all <code>METHOD</code> nodes in <code>X42</code>&#x27;s Code Property Graph. You can achieve that with the following query:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isExternal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res6</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lang</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Boolean</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.logicalAnd&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;strcmp&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.equals&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;printf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fprintf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;exit&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.greaterThan&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;operator&gt;.indirectIndexAccess&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Don&#x27;t be intimidated by the syntax used in the <code>map</code> <em>Step</em> above. If you examine <code>map(node =&gt; (node.isExternal, node.name))</code> for a bit, you might be able to infer that the first <code>node</code> simply defines the variable that represents the node which preceeds the <code>map</code> <em>Step</em>, that the ASCII arrow <code>=&gt;</code> is just syntax that preceeds the body of a lambda function, and that <code>(node.isExternal, node.name)</code> means that the return value of the lambda is a list which contains the value of the <code>isExternal</code> and <code>name</code> <em>Property Directives</em> for each of the nodes matched in the previous step and also passed into the lambda. In most cases in which you need <code>map</code>, you can simply follow the pattern above. But should you ever feel constrained by the common pattern shown, remember that the function for the <code>map</code> step is written in the Scala programming language, a fact which opens up a wide range of possibilities if you invest a little time learning the language.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="complex-steps"></a>Complex Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#complex-steps" title="Direct link to heading">#</a></h3><p>Another useful <em>Joern Query Component</em> is the <em>Complex Step</em>. <em>Complex Steps</em> combine many simpler steps into one in order to make your queries more concise. There are a number of them available, all with different behaviours, and one good example is <code>isConstructor</code>. Before we use it in a query, here is the <code>X42</code> program again:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// X42.c</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">#include </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics">stdio</span><span class="token generics punctuation" style="color:#393A34">.</span><span class="token generics">h</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">#include </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics">stdlib</span><span class="token generics punctuation" style="color:#393A34">.</span><span class="token generics">h</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">#include </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics">string</span><span class="token generics punctuation" style="color:#393A34">.</span><span class="token generics">h</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;It depends!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;What is the meaning of life?\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Earlier we queried it for all <code>METHOD</code> nodes which had their <code>IS_EXTERNAL</code> property set to <code>false</code> using the <code>isExternal(false)</code> <em>Property Filter Step</em>. Two results came up, even though only one method is explicitly defined:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isExternal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res103</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Two useful <em>Complex Steps</em> are <code>astParent</code> and <code>astChildren</code>, which allow you to steer your traversals through the abstract syntax tree of the program under analysis. Say you&#x27;d like to have a query that returns the <code>CODE</code> property for all nodes of type <code>LITERAL</code> which are AST child nodes of <code>CALL</code> nodes that have <code>println</code> in their <code>NAME</code> property:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;println&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLiteral</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res87</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\&quot;What is the meaning of life?\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;It depends!\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Or taken the other way around, a query which returns the property of all <code>CALL</code> nodes which have AST parent nodes of type <code>LITERAL</code> that have their <code>CODE</code> property set to <code>\&quot;What is the meaning of life?\&quot;</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">literal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;What is the meaning of life?\\n\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astParent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isCall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span></div><div class="token-line" style="color:#393A34"><span class="token plain">res100</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;println&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Describing queries in human language tends to sound peculiar. But so would descriptions of bash one-liners, or basic regular expressions if you&#x27;d try out that exercise. As long as you understand the individual components of a query, it won&#x27;t be hard to construct them correctly and understand clearly what they do.</p><p>One final <em>Joern Query Component</em> we&#x27;ll examine in this article is the <em>Repeat Step</em>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="repeat-steps"></a>Repeat Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#repeat-steps" title="Direct link to heading">#</a></h3><p>There are cases in which queries have repetitions in them and become too long. In order to make them more readable, you can use <em>Repeat Steps</em>. <em>Repeat Steps</em> are traversals that repeat other traversals a number of times.
For example, say you&#x27;d like to find nodes of type <code>LITERAL</code> in <code>X42</code>&#x27;s Code Property Graph that are directly reachable from the node which represents the <code>main</code> method. One way of doing that is by using five <code>astChildren</code> <em>Complex Steps</em> in combination with <code>isLiteral</code>, which is another <em>Complex Step</em> that filters for AST nodes of type <code>LITERAL</code> and maps them to actual <code>LITERAL</code> nodes,  plus the <code>code(&quot;42&quot;)</code> <em>Property Filter Step</em>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLiteral</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res137</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Literal</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000050L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    typeFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;int&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dynamicTypeHintFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>The query might do the job, but it is hard to read and change. <code>repeat-times</code> makes the query clearer:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">repeat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLiteral</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res138</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">Literal</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000050L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    typeFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;int&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dynamicTypeHintFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>And even better is another variant of <code>repeat</code>, namely <code>repeat-until</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">joern</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cpg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">repeat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astChildren</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">until</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLiteral</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span></div><div class="token-line" style="color:#393A34"><span class="token plain">res139</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token class-name">AstNode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000050L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;42&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    order </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    argumentIndex </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    typeFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;int&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    dynamicTypeHintFullName </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    lineNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    columnNumber </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    depthFirstOrder </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    internalFlags </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>We won&#x27;t go any further in this article. If you&#x27;ve read so far, you already have a good overview of the most important <em>Joern Query Components</em>. And while the examples you&#x27;ve seen focused on the simple <code>X42</code> program, rest assured, queries that find serious vulnerabilities in programs with millions of lines of code are not much different. Master these basics and you will already have found a strong tool in your code analysis arsenal. As soon as you feel ready, explore the more advanced walkthroughs for a level-up. Have fun!</p></div></article></div></div><div class="col col--3"><div class="tableOfContents_tVyB"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-anatomy-of-an-joern-query" class="table-of-contents__link">The Anatomy of an Joern Query</a></li><li><a href="#importing-a-sample-project" class="table-of-contents__link">Importing a Sample Project</a></li><li><a href="#a-first-traversal" class="table-of-contents__link">A First Traversal</a><ul><li><a href="#node-type-steps" class="table-of-contents__link">Node-Type Steps</a></li><li><a href="#filter-steps" class="table-of-contents__link">Filter Steps</a></li><li><a href="#map-steps" class="table-of-contents__link">Map Steps</a></li><li><a href="#complex-steps" class="table-of-contents__link">Complex Steps</a></li><li><a href="#repeat-steps" class="table-of-contents__link">Repeat Steps</a></li></ul></li></ul></div></div></div></div></main></div></div><div id="right-spacer"></div></div></div></div>
<script src="/styles.63ef370e.js"></script>
<script src="/runtime~main.a31b6222.js"></script>
<script src="/main.a1a9c2ad.js"></script>
<script src="/1.e1eda06e.js"></script>
<script src="/39.4197c376.js"></script>
<script src="/1be78505.cc91c0fc.js"></script>
<script src="/ec1ed54d.6e92f1ec.js"></script>
<script src="/8b5d902e.9e1d82bf.js"></script>
</body>
</html>